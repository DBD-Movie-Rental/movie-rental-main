openapi: 3.0.3
info:
  title: Movie Rental API (Polyglot Backends)
  version: 1.0.0
  description: >
    Unified OpenAPI specification for the Movie Rental system.
    Exposes MySQL (CRUD + stored procedures), MongoDB (read models),
    and Neo4j (graph-related) endpoints.

servers:
  - url: /api/v1

tags:
  - name: MySQL
    description: Endpoints backed by the MySQL database
  - name: MongoDB
    description: Read-model and reporting endpoints backed by MongoDB
  - name: Neo4j
    description: Graph-related endpoints backed by Neo4j

paths:
  ####################
  # Health Endpoints #
  ####################
  /mysql/health:
    get:
      tags: [MySQL]
      summary: MySQL health check
      responses:
        '200':
          description: OK

  /mongodb/health:
    get:
      tags: [MongoDB]
      summary: MongoDB health check
      responses:
        '200':
          description: OK

  /neo4j/health:
    get:
      tags: [Neo4j]
      summary: Neo4j health check
      responses:
        '200':
          description: OK

  ####################
  # MySQL Endpoints  #
  ####################

  /mysql/customers:
    get:
      tags: [MySQL]
      summary: List customers
      responses:
        '200':
          description: List of customers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Customer'
    post:
      tags: [MySQL]
      summary: Create customer (uses stored procedure)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerCreate'
      responses:
        '201':
          description: Customer created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Customer'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/ServerError'

  /mysql/customers/{id}:
    get:
      tags: [MySQL]
      summary: Get customer by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Customer found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Customer'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update customer
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Customer'
      responses:
        '200':
          description: Customer updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Customer'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete customer
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Customer deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/genres:
    get:
      tags: [MySQL]
      summary: List genres
      responses:
        '200':
          description: List of genres
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Genre'
    post:
      tags: [MySQL]
      summary: Create genre
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Genre'
      responses:
        '201':
          description: Genre created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Genre'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/genres/{id}:
    get:
      tags: [MySQL]
      summary: Get genre by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Genre found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Genre'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update genre
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Genre'
      responses:
        '200':
          description: Genre updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Genre'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete genre
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Genre deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/movies:
    get:
      tags: [MySQL]
      summary: List movies
      responses:
        '200':
          description: List of movies
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Movie'
    post:
      tags: [MySQL]
      summary: Create movie
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Movie'
      responses:
        '201':
          description: Movie created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Movie'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/movies/{id}:
    get:
      tags: [MySQL]
      summary: Get movie by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Movie found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Movie'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update movie
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Movie'
      responses:
        '200':
          description: Movie updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Movie'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete movie
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Movie deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/employees:
    get:
      tags: [MySQL]
      summary: List employees
      responses:
        '200':
          description: List of employees
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Employee'
    post:
      tags: [MySQL]
      summary: Create employee
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Employee'
      responses:
        '201':
          description: Employee created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Employee'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/employees/{id}:
    get:
      tags: [MySQL]
      summary: Get employee by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Employee found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Employee'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update employee
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Employee'
      responses:
        '200':
          description: Employee updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Employee'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete employee
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Employee deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/addresses:
    get:
      tags: [MySQL]
      summary: List addresses
      responses:
        '200':
          description: List of addresses
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Address'
    post:
      tags: [MySQL]
      summary: Create address
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Address'
      responses:
        '201':
          description: Address created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Address'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/addresses/{id}:
    get:
      tags: [MySQL]
      summary: Get address by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Address found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Address'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update address
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Address'
      responses:
        '200':
          description: Address updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Address'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete address
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Address deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/fees:
    get:
      tags: [MySQL]
      summary: List fees
      responses:
        '200':
          description: List of fees
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Fee'
    post:
      tags: [MySQL]
      summary: Create fee
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Fee'
      responses:
        '201':
          description: Fee created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Fee'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/fees/{id}:
    get:
      tags: [MySQL]
      summary: Get fee by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Fee found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Fee'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update fee
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Fee'
      responses:
        '200':
          description: Fee updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Fee'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete fee
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Fee deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/formats:
    get:
      tags: [MySQL]
      summary: List formats
      responses:
        '200':
          description: List of formats
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Format'
    post:
      tags: [MySQL]
      summary: Create format
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Format'
      responses:
        '201':
          description: Format created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Format'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/formats/{id}:
    get:
      tags: [MySQL]
      summary: Get format by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Format found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Format'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update format
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Format'
      responses:
        '200':
          description: Format updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Format'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete format
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Format deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/locations:
    get:
      tags: [MySQL]
      summary: List locations
      responses:
        '200':
          description: List of locations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Location'
    post:
      tags: [MySQL]
      summary: Create location
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Location'
      responses:
        '201':
          description: Location created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Location'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/locations/{id}:
    get:
      tags: [MySQL]
      summary: Get location by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Location found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Location'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update location
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Location'
      responses:
        '200':
          description: Location updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Location'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete location
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Location deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/inventory_items:
    get:
      tags: [MySQL]
      summary: List inventory items
      responses:
        '200':
          description: List of inventory items
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/InventoryItem'
    post:
      tags: [MySQL]
      summary: Create inventory item
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InventoryItem'
      responses:
        '201':
          description: Inventory item created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InventoryItem'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/inventory_items/{id}:
    get:
      tags: [MySQL]
      summary: Get inventory item by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Inventory item found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InventoryItem'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update inventory item
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InventoryItem'
      responses:
        '200':
          description: Inventory item updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InventoryItem'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete inventory item
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Inventory item deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/memberships:
    get:
      tags: [MySQL]
      summary: List memberships
      responses:
        '200':
          description: List of memberships
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Membership'
    post:
      tags: [MySQL]
      summary: Create membership
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Membership'
      responses:
        '201':
          description: Membership created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Membership'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/memberships/{id}:
    get:
      tags: [MySQL]
      summary: Get membership by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Membership found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Membership'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update membership
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Membership'
      responses:
        '200':
          description: Membership updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Membership'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete membership
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Membership deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/membership_plans:
    get:
      tags: [MySQL]
      summary: List membership plans
      responses:
        '200':
          description: List of membership plans
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MembershipPlan'
    post:
      tags: [MySQL]
      summary: Create membership plan
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MembershipPlan'
      responses:
        '201':
          description: Membership plan created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MembershipPlan'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/membership_plans/{id}:
    get:
      tags: [MySQL]
      summary: Get membership plan by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Membership plan found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MembershipPlan'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update membership plan
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MembershipPlan'
      responses:
        '200':
          description: Membership plan updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MembershipPlan'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete membership plan
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Membership plan deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/promo_codes:
    get:
      tags: [MySQL]
      summary: List promo codes
      responses:
        '200':
          description: List of promo codes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PromoCode'
    post:
      tags: [MySQL]
      summary: Create promo code
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromoCode'
      responses:
        '201':
          description: Promo code created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromoCode'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/promo_codes/{id}:
    get:
      tags: [MySQL]
      summary: Get promo code by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Promo code found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromoCode'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update promo code
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromoCode'
      responses:
        '200':
          description: Promo code updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromoCode'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete promo code
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Promo code deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/rentals:
    get:
      tags: [MySQL]
      summary: List rentals
      responses:
        '200':
          description: List of rentals
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Rental'
    post:
      tags: [MySQL]
      summary: Create rental (uses stored procedure)
      description: >
        Creates a rental using the MySQL stored procedure create_rental.
        Expects a list of inventory item IDs in the request body.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RentalCreate'
      responses:
        '201':
          description: Rental created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Rental'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/ServerError'

  /mysql/rentals/{id}:
    get:
      tags: [MySQL]
      summary: Get rental by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Rental found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Rental'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update rental
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Rental'
      responses:
        '200':
          description: Rental updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Rental'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete rental
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Rental deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/rentals/reservations:
    post:
      tags: [MySQL]
      summary: Create rental reservation (uses stored procedure)
      description: >
        Creates a rental with status=RESERVED using the create_reservation
        stored procedure. Inventory availability is validated in the database.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RentalCreate'
      responses:
        '201':
          description: Reservation created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Rental'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/ServerError'

  /mysql/payments:
    get:
      tags: [MySQL]
      summary: List payments
      responses:
        '200':
          description: List of payments
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Payment'
    post:
      tags: [MySQL]
      summary: Create payment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Payment'
      responses:
        '201':
          description: Payment created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/payments/{id}:
    get:
      tags: [MySQL]
      summary: Get payment by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Payment found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update payment
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Payment'
      responses:
        '200':
          description: Payment updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete payment
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Payment deleted
        '404':
          $ref: '#/components/responses/NotFound'

  /mysql/reviews:
    get:
      tags: [MySQL]
      summary: List reviews
      responses:
        '200':
          description: List of reviews
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Review'
    post:
      tags: [MySQL]
      summary: Create review
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Review'
      responses:
        '201':
          description: Review created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Review'
        '400':
          $ref: '#/components/responses/BadRequest'

  /mysql/reviews/{id}:
    get:
      tags: [MySQL]
      summary: Get review by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Review found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Review'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [MySQL]
      summary: Update review
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Review'
      responses:
        '200':
          description: Review updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Review'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [MySQL]
      summary: Delete review
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Review deleted
        '404':
          $ref: '#/components/responses/NotFound'

  #####################
  # MongoDB Endpoints #
  #####################

  /mongodb/customers:
    get:
      tags: [MongoDB]
      summary: List MongoDB customers (flat)
      responses:
        '200':
          description: List of customers (denormalized)
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Customer'

  /mongodb/customers/detailed:
    get:
      tags: [MongoDB]
      summary: List detailed customers
      description: >
        Returns customers with embedded membership, rentals and related data
        from MongoDB read models.
      responses:
        '200':
          description: List of detailed customers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MongoCustomerDetailed'

  /mongodb/rentals:
    get:
      tags: [MongoDB]
      summary: List MongoDB rentals (flat)
      responses:
        '200':
          description: List of rentals stored in MongoDB
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Rental'

  /mongodb/rentals/detailed:
    get:
      tags: [MongoDB]
      summary: List detailed rentals
      description: >
        Returns rentals with embedded items, customer, payments and fees
        from MongoDB read models.
      responses:
        '200':
          description: List of detailed rentals
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MongoRentalDetailed'

  /mongodb/movies:
    get:
      tags: [MongoDB]
      summary: List MongoDB movies
      responses:
        '200':
          description: List of movies from MongoDB
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Movie'

  ####################
  # Neo4j Endpoints  #
  ####################

  /neo4j/movies/popular:
    get:
      tags: [Neo4j]
      summary: Get popular movies from Neo4j
      description: >
        Returns movies ranked by relationships and metrics stored in Neo4j
        (for example, most co-rented, highly connected, etc.).
      responses:
        '200':
          description: List of popular movies
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Movie'

components:
  responses:
    BadRequest:
      description: Bad request
    NotFound:
      description: Resource not found
    ServerError:
      description: Internal server error

  schemas:
    Address:
      type: object
      properties:
        id:
          type: integer
        address:
          type: string
        city:
          type: string
        post_code:
          type: string

    Customer:
      type: object
      properties:
        id:
          type: integer
        first_name:
          type: string
        last_name:
          type: string
        email:
          type: string
        phone_number:
          type: string
        address_id:
          type: integer

    CustomerCreate:
      type: object
      required:
        - first_name
        - last_name
        - email
        - phone_number
        - address
        - city
        - post_code
      properties:
        first_name:
          type: string
        last_name:
          type: string
        email:
          type: string
        phone_number:
          type: string
        address:
          type: string
        city:
          type: string
        post_code:
          type: string

    Genre:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string

    Movie:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        description:
          type: string
        release_year:
          type: integer
        genre_id:
          type: integer
        format_id:
          type: integer

    Employee:
      type: object
      properties:
        id:
          type: integer
        first_name:
          type: string
        last_name:
          type: string
        email:
          type: string

    Fee:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        amount:
          type: number
          format: float

    Format:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string

    Location:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        address_id:
          type: integer

    InventoryItem:
      type: object
      properties:
        id:
          type: integer
        movie_id:
          type: integer
        location_id:
          type: integer
        status:
          type: integer
          description: 1 = available, 0 = unavailable

    Membership:
      type: object
      properties:
        id:
          type: integer
        customer_id:
          type: integer
        membership_plan_id:
          type: integer
        start_date:
          type: string
          format: date
        end_date:
          type: string
          format: date

    MembershipPlan:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        monthly_fee:
          type: number
          format: float
        max_rentals:
          type: integer

    PromoCode:
      type: object
      properties:
        id:
          type: integer
        code:
          type: string
        discount_percent:
          type: number
          format: float
        valid_from:
          type: string
          format: date
        valid_to:
          type: string
          format: date

    Rental:
      type: object
      properties:
        id:
          type: integer
        rented_at_datetime:
          type: string
          format: date-time
          nullable: true
        returned_at_datetime:
          type: string
          format: date-time
          nullable: true
        due_at_datetime:
          type: string
          format: date-time
          nullable: true
        reserved_at_datetime:
          type: string
          format: date-time
          nullable: true
        status:
          type: string
          enum: [RESERVED, OPEN, RETURNED, LATE, CANCELLED]
        customer_id:
          type: integer
        employee_id:
          type: integer
          nullable: true
        promo_code_id:
          type: integer
          nullable: true

    RentalCreate:
      type: object
      required:
        - customer_id
        - inventory_item_ids
      properties:
        customer_id:
          type: integer
          description: ID of the customer renting or reserving.
        employee_id:
          type: integer
          nullable: true
          description: Optional employee handling the rental.
        promo_code_id:
          type: integer
          nullable: true
          description: Optional promo code applied to the rental.
        inventory_item_ids:
          type: array
          description: List of inventory_item IDs included in this rental/reservation.
          items:
            type: integer

    Payment:
      type: object
      properties:
        id:
          type: integer
        rental_id:
          type: integer
        amount:
          type: number
          format: float
        paid_at_datetime:
          type: string
          format: date-time

    Review:
      type: object
      properties:
        id:
          type: integer
        customer_id:
          type: integer
        movie_id:
          type: integer
        rating:
          type: integer
        comment:
          type: string

    MongoRentalDetailed:
      type: object
      description: Detailed rental projection stored in MongoDB.
      properties:
        rental:
          $ref: '#/components/schemas/Rental'
        customer:
          $ref: '#/components/schemas/Customer'
        items:
          type: array
          items:
            $ref: '#/components/schemas/InventoryItem'
        payments:
          type: array
          items:
            $ref: '#/components/schemas/Payment'
        fees:
          type: array
          items:
            $ref: '#/components/schemas/Fee'

    MongoCustomerDetailed:
      type: object
      description: Detailed customer projection stored in MongoDB.
      properties:
        customer:
          $ref: '#/components/schemas/Customer'
        membership:
          $ref: '#/components/schemas/Membership'
        rentals:
          type: array
          items:
            $ref: '#/components/schemas/Rental'